<% layout("/layouts/boilerplate") %>
  <%- include('../partials/flash.ejs') %>

    <head>
      <style>
        .btn-styling {
          background-color: #fe424d !important;
          border: none !important;
        }
      </style>
    </head>

    <body>
      <div class="row">
        <div class="col-8 offset-2">
          <form method="POST" action="/listing" class="row g-3 needs-validation" enctype="multipart/form-data"
            novalidate>
            <h3>Create New Listing</h3>

            <!-- Title -->
            <div class="col-md-12">
              <label class="form-label" for="title">Title</label>
              <input name="title" pattern="^[A-Za-z\s]+$" class="form-control" id="title" placeholder="Enter title"
                required type="text">
              <div class="invalid-feedback">Please provide a title (letters only, no numbers).</div>
              <div class="valid-feedback">Title looks good!</div>
            </div>

            <!-- Description -->
            <div class="col-md-12">
              <label class="form-label" for="description">Description</label>
              <textarea name="description" class="form-control" id="description" placeholder="Enter description"
                required></textarea>
              <div class="invalid-feedback">Please provide a description.</div>
              <div class="valid-feedback">Description looks good!</div>
            </div>

            <!-- Image URL
        <div class="col-md-12">
          <label class="form-label" for="image">Image URL</label>
          <input 
            name="image" 
            class="form-control" 
            id="image" 
            placeholder="Enter image URL" 
            type="url">
          <div class="invalid-feedback">Please provide a valid image URL.</div>
          <div class="valid-feedback">Image URL looks good!</div>
        </div> -->


            <!-- Image File -->
            <div class="col-md-12">
              <label class="form-label" for="image">Upload Listing Image</label>
              <input name="listing[image]" class="form-control" id="image" type="file">

              <div class="invalid-feedback">Please provide a valid image URL.</div>
              <div class="valid-feedback">Image URL looks good!</div>
            </div>

            <!-- Price -->
            <div class="col-md-4">
              <label class="form-label" for="price">Price</label>
              <input name="price" class="form-control" id="price" placeholder="Price" type="number" min="1" required>
              <div class="invalid-feedback">Please provide a valid price (greater than 0).</div>
              <div class="valid-feedback">Price looks good!</div>
            </div>

            <!-- Country -->
            <div class="col-md-8">
              <label class="form-label" for="country">Country</label>
              <input name="country" pattern="^[A-Za-z\s]+$" class="form-control" id="country"
                placeholder="Enter country" type="text" required>
              <div class="invalid-feedback">Please provide a valid country (letters only).</div>
              <div class="valid-feedback">Country looks good!</div>
            </div>

            <!-- City -->
            <div class="col-md-12">
              <label class="form-label" for="location">City</label>
              <input name="location" pattern="^[A-Za-z\s]+$" class="form-control" id="location" placeholder="Enter city"
                type="text" required>
              <div class="invalid-feedback">Please provide a valid city (letters only).</div>
              <div class="valid-feedback">City looks good!</div>
            </div>

            <!-- Terms Checkbox -->
            <div class="col-12">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="termsCheck" required>
                <label class="form-check-label" for="termsCheck">
                  Agree to terms and conditions
                </label>
                <div class="invalid-feedback">You must agree before submitting.</div>
                <div class="valid-feedback">Thank you for agreeing!</div>
              </div>
            </div>

            <!-- Submit -->
            <div class="col-12">
              <button class="btn btn-dark btn-styling" type="submit">Add</button>
            </div>
          </form>
          <br><br>
        </div>
      </div>

      <script>
        // Bootstrap validation script
        (function () {
          'use strict';
          const forms = document.querySelectorAll('.needs-validation');
          Array.from(forms).forEach(function (form) {
            form.addEventListener('submit', function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add('was-validated');
            }, false);
          });
        })();
      </script>
    </body>